Write-Host "🚀 Starting Blue-Green Deployment..."

Write-Host "🟦 Deploying BLUE version..."
kubectl apply -f blue_deployment.yaml

Write-Host "🟩 Deploying GREEN version..."
kubectl apply -f green_deployment.yaml

Write-Host "🔁 Applying service..."
kubectl apply -f kubeservice.yaml

Write-Host "📦 Current running pods:"
kubectl get pods -l app=messaging-app

Write-Host "🧠 Checking GREEN pod logs..."
# Get the first green pod
$greenPod = kubectl get pods -l version=green -o jsonpath="{.items[0].metadata.name}"
kubectl logs $greenPod

Write-Host "✅ Blue-Green deployment completed!"
